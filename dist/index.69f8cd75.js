var e,t,n,r,i,o,a,s,l,u,c,d,f,h,p,m,g,v,y,b,w,_,C,x=globalThis;function S(e){return e&&e.__esModule?e.default:e}var k={},T={},O=x.parcelRequire4e23;null==O&&((O=function(e){if(e in k)return k[e].exports;if(e in T){var t=T[e];delete T[e];var n={id:e,exports:{}};return k[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){T[e]=t},x.parcelRequire4e23=O),(0,O.register)("cVm5l",function(e,t){var n;/*! For license information please see lsplugin.user.js.LICENSE.txt */self,n=()=>(()=>{var n={227:(e,t,n)=>{let r;var i=n(155);t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;let n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))}),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG),e},t.useColors=function(){return"undefined"!=typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(r=!1,()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(447)(t);let{formatters:o}=e.exports;o.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,o,a=null;function s(...e){if(!s.enabled)return;let r=Number(new Date),i=r-(n||r);s.diff=i,s.prev=n,s.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";o++;let i=t.formatters[r];if("function"==typeof i){let t=e[o];n=i.call(s,t),e.splice(o,1),o--}return n}),t.formatArgs.call(s,e),(s.log||t.log).apply(s,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){let r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){let e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];let r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(RegExp("^"+e.slice(1)+"$")):t.names.push(RegExp("^"+e+"$")))},t.enabled=function(e){let n,r;if("*"===e[e.length-1])return!0;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t)|0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},996:e=>{var t=function(e){var t;return!!e&&"object"==typeof e&&"[object RegExp]"!==(t=Object.prototype.toString.call(e))&&"[object Date]"!==t&&e.$$typeof!==n},n="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?s(Array.isArray(e)?[]:{},e,t):e}function i(e,t,n){return e.concat(t).map(function(e){return r(e,n)})}function o(e){return Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[])}function a(e,t){try{return t in e}catch(e){return!1}}function s(e,n,l){(l=l||{}).arrayMerge=l.arrayMerge||i,l.isMergeableObject=l.isMergeableObject||t,l.cloneUnlessOtherwiseSpecified=r;var u,c,d=Array.isArray(n);return d===Array.isArray(e)?d?l.arrayMerge(e,n,l):(c={},(u=l).isMergeableObject(e)&&o(e).forEach(function(t){c[t]=r(e[t],u)}),o(n).forEach(function(t){a(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))||(a(e,t)&&u.isMergeableObject(n[t])?c[t]=(function(e,t){if(!t.customMerge)return s;var n=t.customMerge(e);return"function"==typeof n?n:s})(t,u)(e[t],n[t],u):c[t]=r(n[t],u))}),c):r(n,l)}s.all=function(e,t){if(!Array.isArray(e))throw Error("first argument should be an array");return e.reduce(function(e,n){return s(e,n,t)},{})},e.exports=s},856:function(e){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,n){return(t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,n)}function n(e,r,i){return(n=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,n,r){var i=[null];i.push.apply(i,n);var o=new(Function.bind.apply(e,i));return r&&t(o,r.prototype),o}:Reflect.construct).apply(null,arguments)}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,void 0):void 0}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var o,a=Object.hasOwnProperty,s=Object.setPrototypeOf,l=Object.isFrozen,u=Object.getPrototypeOf,c=Object.getOwnPropertyDescriptor,d=Object.freeze,f=Object.seal,h=Object.create,p="undefined"!=typeof Reflect&&Reflect,m=p.apply,g=p.construct;m||(m=function(e,t,n){return e.apply(t,n)}),d||(d=function(e){return e}),f||(f=function(e){return e}),g||(g=function(e,t){return n(e,r(t))});var v=O(Array.prototype.forEach),y=O(Array.prototype.pop),b=O(Array.prototype.push),w=O(String.prototype.toLowerCase),_=O(String.prototype.match),C=O(String.prototype.replace),x=O(String.prototype.indexOf),S=O(String.prototype.trim),k=O(RegExp.prototype.test),T=(o=TypeError,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return g(o,t)});function O(e){return function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return m(e,t,r)}}function M(e,t){s&&s(e,null);for(var n=t.length;n--;){var r=t[n];if("string"==typeof r){var i=w(r);i!==r&&(l(t)||(t[n]=i),r=i)}e[r]=!0}return e}function E(e){var t,n=h(null);for(t in e)m(a,e,[t])&&(n[t]=e[t]);return n}function A(e,t){for(;null!==e;){var n=c(e,t);if(n){if(n.get)return O(n.get);if("function"==typeof n.value)return O(n.value)}e=u(e)}return function(e){return console.warn("fallback value for",e),null}}var j=d(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=d(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),N=d(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),I=d(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),P=d(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),F=d(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),L=d(["#text"]),$=d(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),U=d(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R=d(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),z=d(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=f(/\{\{[\w\W]*|[\w\W]*\}\}/gm),q=f(/<%[\w\W]*|[\w\W]*%>/gm),W=f(/^data-[\-\w.\u00B7-\uFFFF]/),B=f(/^aria-[\-\w]+$/),Y=f(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G=f(/^(?:\w+script|data):/i),J=f(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=f(/^html$/i),V=function(t,n){if("object"!==e(t)||"function"!=typeof t.createPolicy)return null;var r=null,i="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(i)&&(r=n.currentScript.getAttribute(i));var o="dompurify"+(r?"#"+r:"");try{return t.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,i=function(e){return t(e)};if(i.version="2.3.8",i.removed=[],!n||!n.document||9!==n.document.nodeType)return i.isSupported=!1,i;var o=n.document,a=n.document,s=n.DocumentFragment,l=n.HTMLTemplateElement,u=n.Node,c=n.Element,f=n.NodeFilter,h=n.NamedNodeMap,p=void 0===h?n.NamedNodeMap||n.MozNamedAttrMap:h,m=n.HTMLFormElement,g=n.DOMParser,O=n.trustedTypes,X=c.prototype,Z=A(X,"cloneNode"),K=A(X,"nextSibling"),ee=A(X,"childNodes"),et=A(X,"parentNode");if("function"==typeof l){var en=a.createElement("template");en.content&&en.content.ownerDocument&&(a=en.content.ownerDocument)}var er=V(O,o),ei=er?er.createHTML(""):"",eo=a,ea=eo.implementation,es=eo.createNodeIterator,el=eo.createDocumentFragment,eu=eo.getElementsByTagName,ec=o.importNode,ed={};try{ed=E(a).documentMode?a.documentMode:{}}catch(e){}var ef={};i.isSupported="function"==typeof et&&ea&&void 0!==ea.createHTMLDocument&&9!==ed;var eh,ep,em=Y,eg=null,ev=M({},[].concat(r(j),r(D),r(N),r(P),r(L))),ey=null,eb=M({},[].concat(r($),r(U),r(R),r(z))),ew=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),e_=null,eC=null,ex=!0,eS=!0,ek=!1,eT=!1,eO=!1,eM=!1,eE=!1,eA=!1,ej=!1,eD=!1,eN=!0,eI=!0,eP=!1,eF={},eL=null,e$=M({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eU=null,eR=M({},["audio","video","img","source","image","track"]),ez=null,eH=M({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eq="http://www.w3.org/1998/Math/MathML",eW="http://www.w3.org/2000/svg",eB="http://www.w3.org/1999/xhtml",eY=eB,eG=!1,eJ=["application/xhtml+xml","text/html"],eQ=null,eV=a.createElement("form"),eX=function(e){return e instanceof RegExp||e instanceof Function},eZ=function(t){eQ&&eQ===t||(t&&"object"===e(t)||(t={}),eg="ALLOWED_TAGS"in(t=E(t))?M({},t.ALLOWED_TAGS):ev,ey="ALLOWED_ATTR"in t?M({},t.ALLOWED_ATTR):eb,ez="ADD_URI_SAFE_ATTR"in t?M(E(eH),t.ADD_URI_SAFE_ATTR):eH,eU="ADD_DATA_URI_TAGS"in t?M(E(eR),t.ADD_DATA_URI_TAGS):eR,eL="FORBID_CONTENTS"in t?M({},t.FORBID_CONTENTS):e$,e_="FORBID_TAGS"in t?M({},t.FORBID_TAGS):{},eC="FORBID_ATTR"in t?M({},t.FORBID_ATTR):{},eF="USE_PROFILES"in t&&t.USE_PROFILES,ex=!1!==t.ALLOW_ARIA_ATTR,eS=!1!==t.ALLOW_DATA_ATTR,ek=t.ALLOW_UNKNOWN_PROTOCOLS||!1,eT=t.SAFE_FOR_TEMPLATES||!1,eO=t.WHOLE_DOCUMENT||!1,eA=t.RETURN_DOM||!1,ej=t.RETURN_DOM_FRAGMENT||!1,eD=t.RETURN_TRUSTED_TYPE||!1,eE=t.FORCE_BODY||!1,eN=!1!==t.SANITIZE_DOM,eI=!1!==t.KEEP_CONTENT,eP=t.IN_PLACE||!1,em=t.ALLOWED_URI_REGEXP||em,eY=t.NAMESPACE||eB,t.CUSTOM_ELEMENT_HANDLING&&eX(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ew.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&eX(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ew.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ew.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ep="application/xhtml+xml"===(eh=eh=-1===eJ.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?function(e){return e}:w,eT&&(eS=!1),ej&&(eA=!0),eF&&(eg=M({},r(L)),ey=[],!0===eF.html&&(M(eg,j),M(ey,$)),!0===eF.svg&&(M(eg,D),M(ey,U),M(ey,z)),!0===eF.svgFilters&&(M(eg,N),M(ey,U),M(ey,z)),!0===eF.mathMl&&(M(eg,P),M(ey,R),M(ey,z))),t.ADD_TAGS&&(eg===ev&&(eg=E(eg)),M(eg,t.ADD_TAGS)),t.ADD_ATTR&&(ey===eb&&(ey=E(ey)),M(ey,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&M(ez,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(eL===e$&&(eL=E(eL)),M(eL,t.FORBID_CONTENTS)),eI&&(eg["#text"]=!0),eO&&M(eg,["html","head","body"]),eg.table&&(M(eg,["tbody"]),delete e_.tbody),d&&d(t),eQ=t)},eK=M({},["mi","mo","mn","ms","mtext"]),e0=M({},["foreignobject","desc","title","annotation-xml"]),e1=M({},["title","style","font","a","script"]),e3=M({},D);M(e3,N),M(e3,I);var e2=M({},P);M(e2,F);var e6=function(e){var t=et(e);t&&t.tagName||(t={namespaceURI:eB,tagName:"template"});var n=w(e.tagName),r=w(t.tagName);return e.namespaceURI===eW?t.namespaceURI===eB?"svg"===n:t.namespaceURI===eq?"svg"===n&&("annotation-xml"===r||eK[r]):!!e3[n]:e.namespaceURI===eq?t.namespaceURI===eB?"math"===n:t.namespaceURI===eW?"math"===n&&e0[r]:!!e2[n]:e.namespaceURI===eB&&!(t.namespaceURI===eW&&!e0[r])&&!(t.namespaceURI===eq&&!eK[r])&&!e2[n]&&(e1[n]||!e3[n])},e9=function(e){b(i.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=ei}catch(t){e.remove()}}},e4=function(e,t){try{b(i.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){b(i.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ey[e]){if(eA||ej)try{e9(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}}},e5=function(e){if(eE)e="<remove></remove>"+e;else{var t,n,r=_(e,/^[\r\n\t ]+/);n=r&&r[0]}"application/xhtml+xml"===eh&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=er?er.createHTML(e):e;if(eY===eB)try{t=(new g).parseFromString(i,eh)}catch(e){}if(!t||!t.documentElement){t=ea.createDocument(eY,"template",null);try{t.documentElement.innerHTML=eG?"":i}catch(e){}}var o=t.body||t.documentElement;return e&&n&&o.insertBefore(a.createTextNode(n),o.childNodes[0]||null),eY===eB?eu.call(t,eO?"html":"body")[0]:eO?t.documentElement:o},e7=function(e){return es.call(e.ownerDocument||e,e,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT,null,!1)},e8=function(t){return"object"===e(u)?t instanceof u:t&&"object"===e(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},te=function(e,t,n){ef[e]&&v(ef[e],function(e){e.call(i,t,n,eQ)})},tt=function(e){if(te("beforeSanitizeElements",e,null),e instanceof m&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof p)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)||k(/[\u0080-\uFFFF]/,e.nodeName))return e9(e),!0;var t,n=ep(e.nodeName);if(te("uponSanitizeElement",e,{tagName:n,allowedTags:eg}),e.hasChildNodes()&&!e8(e.firstElementChild)&&(!e8(e.content)||!e8(e.content.firstElementChild))&&k(/<[/\w]/g,e.innerHTML)&&k(/<[/\w]/g,e.textContent)||"select"===n&&k(/<template/i,e.innerHTML))return e9(e),!0;if(!eg[n]||e_[n]){if(!e_[n]&&tr(n)&&(ew.tagNameCheck instanceof RegExp&&k(ew.tagNameCheck,n)||ew.tagNameCheck instanceof Function&&ew.tagNameCheck(n)))return!1;if(eI&&!eL[n]){var r=et(e)||e.parentNode,o=ee(e)||e.childNodes;if(o&&r)for(var a=o.length-1;a>=0;--a)r.insertBefore(Z(o[a],!0),K(e))}return e9(e),!0}return e instanceof c&&!e6(e)?(e9(e),!0):("noscript"===n||"noembed"===n)&&k(/<\/no(script|embed)/i,e.innerHTML)?(e9(e),!0):(eT&&3===e.nodeType&&(t=C(t=e.textContent,H," "),t=C(t,q," "),e.textContent!==t&&(b(i.removed,{element:e.cloneNode()}),e.textContent=t)),te("afterSanitizeElements",e,null),!1)},tn=function(e,t,n){if(eN&&("id"===t||"name"===t)&&(n in a||n in eV))return!1;if(eS&&!eC[t]&&k(W,t));else if(ex&&k(B,t));else if(!ey[t]||eC[t]){if(!(tr(e)&&(ew.tagNameCheck instanceof RegExp&&k(ew.tagNameCheck,e)||ew.tagNameCheck instanceof Function&&ew.tagNameCheck(e))&&(ew.attributeNameCheck instanceof RegExp&&k(ew.attributeNameCheck,t)||ew.attributeNameCheck instanceof Function&&ew.attributeNameCheck(t))||"is"===t&&ew.allowCustomizedBuiltInElements&&(ew.tagNameCheck instanceof RegExp&&k(ew.tagNameCheck,n)||ew.tagNameCheck instanceof Function&&ew.tagNameCheck(n))))return!1}else if(ez[t]);else if(k(em,C(n,J,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==x(n,"data:")||!eU[e]){if(ek&&!k(G,C(n,J,"")));else if(n)return!1}return!0},tr=function(e){return e.indexOf("-")>0},ti=function(e){te("beforeSanitizeAttributes",e,null);var t,n,r,o,a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ey};for(o=a.length;o--;){var l=t=a[o],u=l.name,c=l.namespaceURI;if(n="value"===u?t.value:S(t.value),r=ep(u),s.attrName=r,s.attrValue=n,s.keepAttr=!0,s.forceKeepAttr=void 0,te("uponSanitizeAttribute",e,s),n=s.attrValue,!s.forceKeepAttr&&(e4(u,e),s.keepAttr)){if(k(/\/>/i,n))e4(u,e);else if(eT&&(n=C(n,H," "),n=C(n,q," ")),tn(ep(e.nodeName),r,n))try{c?e.setAttributeNS(c,u,n):e.setAttribute(u,n),y(i.removed)}catch(e){}}}te("afterSanitizeAttributes",e,null)}},to=function e(t){var n,r=e7(t);for(te("beforeSanitizeShadowDOM",t,null);n=r.nextNode();)te("uponSanitizeShadowNode",n,null),tt(n)||(n.content instanceof s&&e(n.content),ti(n));te("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(t,r){if((eG=!t)&&(t="<!-->"),"string"!=typeof t&&!e8(t)){if("function"!=typeof t.toString)throw T("toString is not a function");if("string"!=typeof(t=t.toString()))throw T("dirty is not a string, aborting")}if(!i.isSupported){if("object"===e(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(e8(t))return n.toStaticHTML(t.outerHTML)}return t}if(eM||eZ(r),i.removed=[],"string"==typeof t&&(eP=!1),eP){if(t.nodeName){var a,l,c,d,f,h=ep(t.nodeName);if(!eg[h]||e_[h])throw T("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof u)1===(l=(a=e5("<!---->")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?a=l:a.appendChild(l);else{if(!eA&&!eT&&!eO&&-1===t.indexOf("<"))return er&&eD?er.createHTML(t):t;if(!(a=e5(t)))return eA?null:eD?ei:""}a&&eE&&e9(a.firstChild);for(var p=e7(eP?t:a);c=p.nextNode();)3===c.nodeType&&c===d||tt(c)||(c.content instanceof s&&to(c.content),ti(c),d=c);if(d=null,eP)return t;if(eA){if(ej)for(f=el.call(a.ownerDocument);a.firstChild;)f.appendChild(a.firstChild);else f=a;return ey.shadowroot&&(f=ec.call(o,f,!0)),f}var m=eO?a.outerHTML:a.innerHTML;return eO&&eg["!doctype"]&&a.ownerDocument&&a.ownerDocument.doctype&&a.ownerDocument.doctype.name&&k(Q,a.ownerDocument.doctype.name)&&(m="<!DOCTYPE "+a.ownerDocument.doctype.name+">\n"+m),eT&&(m=C(m,H," "),m=C(m,q," ")),er&&eD?er.createHTML(m):m},i.setConfig=function(e){eZ(e),eM=!0},i.clearConfig=function(){eQ=null,eM=!1},i.isValidAttribute=function(e,t,n){return eQ||eZ({}),tn(ep(e),ep(t),n)},i.addHook=function(e,t){"function"==typeof t&&(ef[e]=ef[e]||[],b(ef[e],t))},i.removeHook=function(e){if(ef[e])return y(ef[e])},i.removeHooks=function(e){ef[e]&&(ef[e]=[])},i.removeAllHooks=function(){ef={}},i}()}()},729:e=>{var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw TypeError("The listener must be a function");var s=new i(r,o||e,a),l=n?n+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,i),!0;case 5:return c.fn.call(c.context,t,r,i,o),!0;case 6:return c.fn.call(c.context,t,r,i,o,a),!0}for(u=1,l=Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var f,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,i);break;default:if(!l)for(f=1,l=Array(d-1);f<d;f++)l[f-1]=arguments[f];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||r&&s[l].context!==r)&&u.push(s[l]);u.length?this._events[o]=1===u.length?u[0]:u:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},717:e=>{"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},824:e=>{function t(e,t,n,r){return Math.round(e/n)+" "+r+(t>=1.5*n?"s":"")}e.exports=function(e,n){n=n||{};var r,i,o=typeof e;if("string"===o&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return 864e5*n;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*n;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===o&&isFinite(e))return n.long?(r=Math.abs(e))>=864e5?t(e,r,864e5,"day"):r>=36e5?t(e,r,36e5,"hour"):r>=6e4?t(e,r,6e4,"minute"):r>=1e3?t(e,r,1e3,"second"):e+" ms":(i=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":i>=36e5?Math.round(e/36e5)+"h":i>=6e4?Math.round(e/6e4)+"m":i>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},520:(e,t,n)=>{var r=n(155),i="win32"===r.platform,o=n(539);function a(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r];i&&"."!==i&&(".."===i?n.length&&".."!==n[n.length-1]?n.pop():t&&n.push(".."):n.push(i))}return n}function s(e){for(var t=e.length-1,n=0;n<=t&&!e[n];n++);for(var r=t;r>=0&&!e[r];r--);return 0===n&&r===t?e:n>r?[]:e.slice(n,r+1)}var l=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,u=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,c={};function d(e){var t=l.exec(e),n=(t[1]||"")+(t[2]||""),r=t[3]||"",i=u.exec(r);return[n,i[1],i[2],i[3]]}function f(e){var t=l.exec(e),n=t[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!t[2],tail:t[3]}}function h(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}c.resolve=function(){for(var e,t="",n="",i=!1,s=arguments.length-1;s>=-1;s--){if(s>=0?e=arguments[s]:t?(e=r.env["="+t])&&e.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(e=t+"\\"):e=r.cwd(),!o.isString(e))throw TypeError("Arguments to path.resolve must be strings");if(e){var l=f(e),u=l.device,c=l.isUnc,d=l.isAbsolute,p=l.tail;if((!u||!t||u.toLowerCase()===t.toLowerCase())&&(t||(t=u),i||(n=p+"\\"+n,i=d),t&&i))break}}return c&&(t=h(t)),t+(i?"\\":"")+(n=a(n.split(/[\\\/]+/),!i).join("\\"))||"."},c.normalize=function(e){var t=f(e),n=t.device,r=t.isUnc,i=t.isAbsolute,o=t.tail,s=/[\\\/]$/.test(o);return(o=a(o.split(/[\\\/]+/),!i).join("\\"))||i||(o="."),o&&s&&(o+="\\"),r&&(n=h(n)),n+(i?"\\":"")+o},c.isAbsolute=function(e){return f(e).isAbsolute},c.join=function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(!o.isString(n))throw TypeError("Arguments to path.join must be strings");n&&e.push(n)}var r=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),c.normalize(r)},c.relative=function(e,t){e=c.resolve(e),t=c.resolve(t);for(var n=e.toLowerCase(),r=t.toLowerCase(),i=s(t.split("\\")),o=s(n.split("\\")),a=s(r.split("\\")),l=Math.min(o.length,a.length),u=l,d=0;d<l;d++)if(o[d]!==a[d]){u=d;break}if(0==u)return t;var f=[];for(d=u;d<o.length;d++)f.push("..");return(f=f.concat(i.slice(u))).join("\\")},c._makeLong=function(e){if(!o.isString(e))return e;if(!e)return"";var t=c.resolve(e);return/^[a-zA-Z]\:\\/.test(t)?"\\\\?\\"+t:/^\\\\[^?.]/.test(t)?"\\\\?\\UNC\\"+t.substring(2):e},c.dirname=function(e){var t=d(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},c.basename=function(e,t){var n=d(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},c.extname=function(e){return d(e)[3]},c.format=function(e){if(!o.isObject(e))throw TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir,r=e.base||"";return n?n[n.length-1]===c.sep?n+r:n+c.sep+r:r},c.parse=function(e){if(!o.isString(e))throw TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=d(e);if(!t||4!==t.length)throw TypeError("Invalid path '"+e+"'");return{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},c.sep="\\",c.delimiter=";";var p=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,m={};function g(e){return p.exec(e).slice(1)}m.resolve=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var i=n>=0?arguments[n]:r.cwd();if(!o.isString(i))throw TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,t="/"===i[0])}return(t?"/":"")+(e=a(e.split("/"),!t).join("/"))||"."},m.normalize=function(e){var t=m.isAbsolute(e),n=e&&"/"===e[e.length-1];return(e=a(e.split("/"),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},m.isAbsolute=function(e){return"/"===e.charAt(0)},m.join=function(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];if(!o.isString(n))throw TypeError("Arguments to path.join must be strings");n&&(e+=e?"/"+n:n)}return m.normalize(e)},m.relative=function(e,t){e=m.resolve(e).substr(1),t=m.resolve(t).substr(1);for(var n=s(e.split("/")),r=s(t.split("/")),i=Math.min(n.length,r.length),o=i,a=0;a<i;a++)if(n[a]!==r[a]){o=a;break}var l=[];for(a=o;a<n.length;a++)l.push("..");return(l=l.concat(r.slice(o))).join("/")},m._makeLong=function(e){return e},m.dirname=function(e){var t=g(e),n=t[0],r=t[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},m.basename=function(e,t){var n=g(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},m.extname=function(e){return g(e)[3]},m.format=function(e){if(!o.isObject(e))throw TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var t=e.root||"";if(!o.isString(t))throw TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);return(e.dir?e.dir+m.sep:"")+(e.base||"")},m.parse=function(e){if(!o.isString(e))throw TypeError("Parameter 'pathString' must be a string, not "+typeof e);var t=g(e);if(!t||4!==t.length)throw TypeError("Invalid path '"+e+"'");return t[1]=t[1]||"",t[2]=t[2]||"",t[3]=t[3]||"",{root:t[0],dir:t[0]+t[1].slice(0,-1),base:t[2],ext:t[3],name:t[2].slice(0,t[2].length-t[3].length)}},m.sep="/",m.delimiter=":",e.exports=i?c:m,e.exports.posix=m,e.exports.win32=c},155:e=>{var t,n,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var s,l=[],u=!1,c=-1;function d(){u&&s&&(u=!1,s.length?l=s.concat(l):c=-1,l.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=l.length;t;){for(s=l,l=[];++c<t;)s&&s[c].run();c=-1,t=l.length}s=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new h(e,t)),1!==l.length||u||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},539:(e,t,n)=>{var r=n(155),i=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),l=r[n];n<o;l=r[++n])m(l)||!w(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(e,i){if(y(n.g.process))return function(){return t.deprecate(e,i).apply(this,arguments)};if(!0===r.noDeprecation)return e;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return e.apply(this,arguments)}};var o,a={};function s(e,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),c(r,e,r.depth)}function l(e,t){var n=s.styles[t];return n?"\x1b["+s.colors[n][0]+"m"+e+"\x1b["+s.colors[n][1]+"m":e}function u(e,t){return e}function c(e,n,r){if(e.customInspect&&n&&x(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i,o,a=n.inspect(r,e);return v(a)||(a=c(e,a,r)),a}var s=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(v(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):p(t)?e.stylize(""+t,"boolean"):m(t)?e.stylize("null","null"):void 0}(e,n);if(s)return s;var l=Object.keys(n),u=(S={},l.forEach(function(e,t){S[e]=!0}),S);if(e.showHidden&&(l=Object.getOwnPropertyNames(n)),C(n)&&(l.indexOf("message")>=0||l.indexOf("description")>=0))return d(n);if(0===l.length){if(x(n)){var w=n.name?": "+n.name:"";return e.stylize("[Function"+w+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return e.stylize(Date.prototype.toString.call(n),"date");if(C(n))return d(n)}var S,k,T="",M=!1,E=["{","}"];return h(n)&&(M=!0,E=["[","]"]),x(n)&&(T=" [Function"+(n.name?": "+n.name:"")+"]"),b(n)&&(T=" "+RegExp.prototype.toString.call(n)),_(n)&&(T=" "+Date.prototype.toUTCString.call(n)),C(n)&&(T=" "+d(n)),0!==l.length||M&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),k=M?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)O(t,String(a))?o.push(f(e,t,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(e,t,n,r,i,!0))}),o}(e,n,r,u,l):l.map(function(t){return f(e,n,r,u,t,M)}),e.seen.pop(),i=T,o=E,k.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?o[0]+(""===i?"":i+"\n ")+" "+k.join(",\n  ")+" "+o[1]:o[0]+i+" "+k.join(", ")+" "+o[1]):E[0]+T+E[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,o){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),O(r,i)||(a="["+i+"]"),s||(0>e.seen.indexOf(l.value)?(s=m(n)?c(e,l.value,null):c(e,l.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),y(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function h(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function g(e){return"number"==typeof e}function v(e){return"string"==typeof e}function y(e){return void 0===e}function b(e){return w(e)&&"[object RegExp]"===S(e)}function w(e){return"object"==typeof e&&null!==e}function _(e){return w(e)&&"[object Date]"===S(e)}function C(e){return w(e)&&("[object Error]"===S(e)||e instanceof Error)}function x(e){return"function"==typeof e}function S(e){return Object.prototype.toString.call(e)}function k(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(y(o)&&(o=r.env.NODE_DEBUG||""),!a[e=e.toUpperCase()]){if(RegExp("\\b"+e+"\\b","i").test(o)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){}}return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=h,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=b,t.isObject=w,t.isDate=_,t.isError=C,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(384);var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(n=[k((e=new Date).getHours()),k(e.getMinutes()),k(e.getSeconds())].join(":"),[e.getDate(),T[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(717),t._extend=function(e,t){if(!t||!w(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e].call(o.exports,o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{i.r(o),i.d(o,{LSPluginUser:()=>nO,setupPluginUserInstance:()=>nM});var n,r,a,s,l=i(520),u=(i(856),i(996)),c=i.n(u),d=function(){return(d=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function f(e){return e.toLowerCase()}var h=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],p=/[^A-Z0-9]+/gi;function m(e,t,n){return t instanceof RegExp?e.replace(t,n):t.reduce(function(e,t){return e.replace(t,n)},e)}var g=i(729),v=i.n(g);function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let b="win32"===navigator.platform.toLowerCase()?l.win32:l.posix,w=function(e,t){var n;return void 0===t&&(t={}),void 0===(n=d({delimiter:"_"},t))&&(n={}),function(e,t){void 0===t&&(t={});for(var n=t.splitRegexp,r=t.stripRegexp,i=t.transform,o=t.delimiter,a=m(m(e,void 0===n?h:n,"$1\0$2"),void 0===r?p:r,"\0"),s=0,l=a.length;"\0"===a.charAt(s);)s++;for(;"\0"===a.charAt(l-1);)l--;return a.slice(s,l).split("\0").map(void 0===i?f:i).join(void 0===o?" ":o)}(e,d({delimiter:"."},n))};class _ extends v(){constructor(e,t){super(),y(this,"_tag",void 0),y(this,"_opts",void 0),y(this,"_logs",[]),this._tag=e,this._opts=t}write(e,t,n){var r,i;null!=t&&t.length&&!0===t[t.length-1]&&(n=!0,t.pop());let o=t.reduce((e,t)=>(t&&t instanceof Error?e+=`${t.message} ${t.stack}`:e+=t.toString(),e),`[${this._tag}][${(new Date).toLocaleTimeString()}] `);this._logs.push([e,o]),(n||null!==(r=this._opts)&&void 0!==r&&r.console)&&(null===(i=console)||void 0===i||i["ERROR"===e?"error":"debug"](`${e}: ${o}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...e){this.write("INFO",e)}error(...e){this.write("ERROR",e)}warn(...e){this.write("WARN",e)}setTag(e){this._tag=e}toJSON(){return this._logs}}function C(e,t){let n,r,i=!1,o=t=>n=>{e&&clearTimeout(e),t(n),i=!0},a=new Promise((i,a)=>{n=o(i),r=o(a),e&&(e=setTimeout(()=>r(Error(`[deferred timeout] ${t}`)),e))});return{created:Date.now(),setTag:e=>t=e,resolve:n,reject:r,promise:a,get settled(){return i}}}let S=new Map;window.__injectedUIEffects=S;var k=i(227),T=i.n(k);function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let M="application/x-postmate-v1+json",E=0,A={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},j=(e,t)=>("string"!=typeof t||e.origin===t)&&!!e.data&&("object"!=typeof e.data||"postmate"in e.data)&&e.data.type===M&&!!A[e.data.postmate];class D{constructor(e){O(this,"parent",void 0),O(this,"frame",void 0),O(this,"child",void 0),O(this,"events",{}),O(this,"childOrigin",void 0),O(this,"listener",void 0),this.parent=e.parent,this.frame=e.frame,this.child=e.child,this.childOrigin=e.childOrigin,this.listener=e=>{if(!j(e,this.childOrigin))return!1;let{data:t,name:n}=((e||{}).data||{}).value||{};"emit"===e.data.postmate&&n in this.events&&this.events[n].forEach(e=>{e.call(this,t)})},this.parent.addEventListener("message",this.listener,!1)}get(e,...t){return new Promise((n,r)=>{let i=++E,o=e=>{e.data.uid===i&&"reply"===e.data.postmate&&(this.parent.removeEventListener("message",o,!1),e.data.error?r(e.data.error):n(e.data.value))};this.parent.addEventListener("message",o,!1),this.child.postMessage({postmate:"request",type:M,property:e,args:t,uid:i},this.childOrigin)})}call(e,t){this.child.postMessage({postmate:"call",type:M,property:e,data:t},this.childOrigin)}on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class N{constructor(e){O(this,"model",void 0),O(this,"parent",void 0),O(this,"parentOrigin",void 0),O(this,"child",void 0),this.model=e.model,this.parent=e.parent,this.parentOrigin=e.parentOrigin,this.child=e.child,this.child.addEventListener("message",e=>{var t;if(!j(e,this.parentOrigin))return;let{property:n,uid:r,data:i,args:o}=e.data;"call"!==e.data.postmate?Promise.resolve("function"==typeof(t=this.model)[n]?t[n].apply(null,o):t[n]).then(t=>{e.source.postMessage({property:n,postmate:"reply",type:M,uid:r,value:t},e.origin)}).catch(t=>{e.source.postMessage({property:n,postmate:"reply",type:M,uid:r,error:t},e.origin)}):n in this.model&&"function"==typeof this.model[n]&&this.model[n](i)})}emit(e,t){this.parent.postMessage({postmate:"emit",type:M,value:{name:e,data:t}},this.parentOrigin)}}class I{constructor(e){O(this,"container",void 0),O(this,"parent",void 0),O(this,"frame",void 0),O(this,"child",void 0),O(this,"childOrigin",void 0),O(this,"url",void 0),O(this,"model",void 0),this.container=e.container,this.url=e.url,this.parent=window,this.frame=document.createElement("iframe"),e.id&&(this.frame.id=e.id),e.name&&(this.frame.name=e.name),this.frame.classList.add.apply(this.frame.classList,e.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=e.model||{}}sendHandshake(e){let t=(e=>{let t=document.createElement("a");t.href=e;let n=t.protocol.length>4?t.protocol:window.location.protocol,r=t.host.length?"80"===t.port||"443"===t.port?t.hostname:t.host:window.location.host;return t.origin||`${n}//${r}`})(e=e||this.url),n,r=0;return new Promise((i,o)=>{let a=e=>!!j(e,t)&&("handshake-reply"===e.data.postmate?(clearInterval(n),this.parent.removeEventListener("message",a,!1),this.childOrigin=e.origin,i(new D(this))):o("Failed handshake"));this.parent.addEventListener("message",a,!1);let s=()=>{r++,this.child.postMessage({postmate:"handshake",type:M,model:this.model},t),5===r&&clearInterval(n)};this.frame.addEventListener("load",()=>{s(),n=setInterval(s,500)}),this.frame.src=e})}destroy(){this.frame.parentNode.removeChild(this.frame)}}O(I,"debug",!1),O(I,"Model",void 0);class P{constructor(e){O(this,"child",void 0),O(this,"model",void 0),O(this,"parent",void 0),O(this,"parentOrigin",void 0),this.child=window,this.model=e,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((e,t)=>{let n=r=>{if(r.data.postmate){if("handshake"===r.data.postmate){this.child.removeEventListener("message",n,!1),r.source.postMessage({postmate:"handshake-reply",type:M},r.origin),this.parentOrigin=r.origin;let t=r.data.model;return t&&Object.keys(t).forEach(e=>{this.model[e]=t[e]}),e(new N(this))}return t("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)})}}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let{importHTML:L,createSandboxContainer:$}=window.QSandbox||{};function U(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise(async(t,n)=>{try{let n=await window.apis.doAction(["readFile",e]);t({text:()=>n})}catch(e){console.error(e),n(e)}}))}class R extends v(){constructor(e){super(),F(this,"_pluginLocal",void 0),F(this,"_frame",void 0),F(this,"_root",void 0),F(this,"_loaded",!1),F(this,"_unmountFns",[]),this._pluginLocal=e,e._dispose(()=>{this._unmount()})}async load(){let{name:e,entry:t}=this._pluginLocal.options;if(this.loaded||!t)return;let{template:n,execScripts:r}=await L(t,{fetch:U});this._mount(n,document.body);let i=$(e,{elementGetter:()=>{var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}}).instance.proxy;i.__shadow_mode__=!0,i.LSPluginLocal=this._pluginLocal,i.LSPluginShadow=this,i.LSPluginUser=i.logseq=new nO(this._pluginLocal.toJSON(),this._pluginLocal.caller);let o=await r(i,!0);this._unmountFns.push(o.unmount),this._loaded=!0}_mount(e,t){let n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${e}</div>`,t.appendChild(n),this.emit("mounted")}_unmount(){for(let e of this._unmountFns)e&&e.call(null)}destroy(){var e,t;null===(e=this.frame)||void 0===e||null===(t=e.parentNode)||void 0===t||t.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var e;return null===(e=this._root)||void 0===e?void 0:e.firstChild}get frame(){return this._frame}}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let H=T()("LSPlugin:caller"),q="#await#response#",W="#lspmsg#error#",B=e=>`#lspmsg#${e}`;class Y extends v(){constructor(e){super(),z(this,"_pluginLocal",void 0),z(this,"_connected",!1),z(this,"_parent",void 0),z(this,"_child",void 0),z(this,"_shadow",void 0),z(this,"_status",void 0),z(this,"_userModel",{}),z(this,"_call",void 0),z(this,"_callUserModel",void 0),z(this,"_debugTag",""),this._pluginLocal=e,e&&(this._debugTag=e.debugTag)}async connectToChild(){if(this._connected)return;let{shadow:e}=this._pluginLocal;e?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(e={}){var t;if(this._connected)return;let n=this,r=null!=this._pluginLocal,i=0,o=new Map,a=C(6e4),s=this._extendUserModel({"#lspmsg#ready#":async e=>{s[B(null==e?void 0:e.pid)]=({type:e,payload:t})=>{H(`[host (_call) -> *user] ${this._debugTag}`,e,t),n.emit(e,t)},await a.resolve()},"#lspmsg#beforeunload#":async e=>{let t=C(1e4);n.emit("beforeunload",Object.assign({actor:t},e)),await t.promise},"#lspmsg#settings#":async({type:e,payload:t})=>{n.emit("settings:changed",t)},"#lspmsg#":async({ns:e,type:t,payload:r})=>{H(`[host (async) -> *user] ${this._debugTag} ns=${e} type=${t}`,r),e&&e.startsWith("hook")?n.emit(`${e}:${t}`,r):n.emit(t,r)},"#lspmsg#reply#":({_sync:e,result:t})=>{if(H(`[sync host -> *user] #${e}`,t),o.has(e)){let n=o.get(e);n&&(null!=t&&t.hasOwnProperty(W)?n.reject(t[W]):n.resolve(t),o.delete(e))}},...e});if(r)return await a.promise,JSON.parse(JSON.stringify(null===(t=this._pluginLocal)||void 0===t?void 0:t.toJSON()));let l=new P(s).sendHandshakeReply();return this._status="pending",await l.then(e=>{this._child=e,this._connected=!0,this._call=async(t,n={},r)=>{if(r){let e=++i;o.set(e,r),n._sync=e,r.setTag(`async call #${e}`),H(`async call #${e}`)}return e.emit(B(s.baseInfo.id),{type:t,payload:n}),null==r?void 0:r.promise},this._callUserModel=async(e,t)=>{try{s[e](t)}catch(t){H(`[model method] #${e} not existed`)}},setInterval(()=>{if(o.size>100)for(let[e,t]of o)t.settled&&o.delete(e)},18e5)}).finally(()=>{this._status=void 0}),await a.promise,s.baseInfo}async call(e,t={}){var n;return null===(n=this._call)||void 0===n?void 0:n.call(this,e,t)}async callAsync(e,t={}){var n;let r=C(1e4);return null===(n=this._call)||void 0===n?void 0:n.call(this,e,t,r)}async callUserModel(e,...t){var n;return null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[e,...t])}async callUserModelAsync(e,...t){var n;return e=`${q}${e}`,null===(n=this._callUserModel)||void 0===n?void 0:n.apply(this,[e,...t])}async _setupIframeSandbox(){let e=this._pluginLocal,t=e.id,n=`${t}_lsp_main`,r=new URL(e.options.entry);r.searchParams.set("__v__",e.options.version);let i=document.querySelector(`#${n}`);i&&i.parentElement.removeChild(i);let o=document.createElement("div");o.classList.add("lsp-iframe-sandbox-container"),o.id=n,o.dataset.pid=t;try{var a;let e=null===(a=await this._pluginLocal._loadLayoutsData())||void 0===a?void 0:a.$$0;if(e){o.dataset.inited_layout="true";let{width:t,height:n,left:r,top:i,vw:a,vh:s}=e;r=Math.max(r,0),r="number"==typeof a?`${Math.min(100*r/a,99)}%`:`${r}px`,i=Math.max(i,45),i="number"==typeof s?`${Math.min(100*i/s,99)}%`:`${i}px`,Object.assign(o.style,{width:t+"px",height:n+"px",left:r,top:i})}}catch(e){console.error("[Restore Layout Error]",e)}document.body.appendChild(o);let s=new I({id:t+"_iframe",container:o,url:r.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(e.toJSON()))}}),l,u=s.sendHandshake();return this._status="pending",new Promise((t,n)=>{l=setTimeout(()=>{n(Error("handshake Timeout")),s.destroy()},4e3),u.then(n=>{this._parent=n,this._connected=!0,this.emit("connected"),n.on(B(e.id),({type:e,payload:t})=>{var n,r;H("[user -> *host] ",e,t),null===(n=this._pluginLocal)||void 0===n||n.emit(e,t||{}),null===(r=this._pluginLocal)||void 0===r||r.caller.emit(e,t||{})}),this._call=async(...t)=>{await n.call(B(e.id),{type:t[0],payload:Object.assign(t[1]||{},{$$pid:e.id})})},this._callUserModel=async(e,...t)=>{if(e.startsWith(q))return await n.get(e.replace(q,""),...t);n.call(e,null==t?void 0:t[0])},t(null)}).catch(e=>{n(e)}).finally(()=>{clearTimeout(l)})}).catch(e=>{throw H("[iframe sandbox] error",e),e}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){let e=this._pluginLocal,t=this._shadow=new R(e);try{this._status="pending",await t.load(),this._connected=!0,this.emit("connected"),this._call=async(t,n={},r)=>{var i;return r&&(n.actor=r),null===(i=this._pluginLocal)||void 0===i||i.emit(t,Object.assign(n,{$$pid:e.id})),null==r?void 0:r.promise},this._callUserModel=async(...e)=>{var t;let n=e[0];null!==(t=n)&&void 0!==t&&t.startsWith(q)&&(n=n.replace(q,""));let r=e[1]||{},i=this._userModel[n];"function"==typeof i&&await i.call(null,r)}}catch(e){throw H("[shadow sandbox] error",e),e}finally{this._status=void 0}}_extendUserModel(e){return Object.assign(this._userModel,e)}_getSandboxIframeContainer(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame.parentNode}_getSandboxShadowContainer(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame.parentNode}_getSandboxIframeRoot(){var e;return null===(e=this._parent)||void 0===e?void 0:e.frame}_getSandboxShadowRoot(){var e;return null===(e=this._shadow)||void 0===e?void 0:e.frame}set debugTag(e){this._debugTag=e}async destroy(){var e;let t=null;this._parent&&(t=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(t=this._getSandboxShadowContainer(),this._shadow.destroy()),null===(e=t)||void 0===e||e.parentNode.removeChild(t)}}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J{constructor(e,t){G(this,"ctx",void 0),G(this,"opts",void 0),this.ctx=e,this.opts=t}get ctxId(){return this.ctx.baseInfo.id}setItem(e,t){var n;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,e,t,null===(n=this.opts)||void 0===n?void 0:n.assets]})}getItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}removeItem(e){var t;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}allKeys(){var e;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}clear(){var e;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,null===(e=this.opts)||void 0===e?void 0:e.assets]})}hasItem(e){var t;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,e,null===(t=this.opts)||void 0===t?void 0:t.assets]})}}class Q{constructor(e){var t;t=void 0,"ctx"in this?Object.defineProperty(this,"ctx",{value:t,enumerable:!0,configurable:!0,writable:!0}):this.ctx=t,this.ctx=e}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(e,...t){var n,r;let i=this.ensureHostScope();return e=null===(n=w(e))||void 0===n?void 0:n.toLowerCase(),null===(r=i.logseq.api["exper_"+e])||void 0===r?void 0:r.apply(i,t)}async loadScripts(...e){(e=e.map(e=>null!=e&&e.startsWith("http")?e:this.ctx.resolveResourceFullUrl(e))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...e)}registerFencedCodeRenderer(e,t){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,e,t)}registerExtensionsEnhancer(e,t){let n=this.ensureHostScope();return"katex"===e&&n.katex&&t(n.katex).catch(console.error),n.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,e,t)}ensureHostScope(){if(window===top)throw Error("Can not access host scope!");return top}}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let X=e=>`task_callback_${e}`;class Z{constructor(e,t,n={}){V(this,"_client",void 0),V(this,"_requestId",void 0),V(this,"_requestOptions",void 0),V(this,"_promise",void 0),V(this,"_aborted",!1),this._client=e,this._requestId=t,this._requestOptions=n,this._promise=new Promise((e,t)=>{if(!this._requestId)return t(null);this._client.once(X(this._requestId),n=>{n&&n instanceof Error?t(n):e(n)})});let{success:r,fail:i,final:o}=this._requestOptions;this._promise.then(e=>{null==r||r(e)}).catch(e=>{null==i||i(e)}).finally(()=>{null==o||o()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class K extends g.EventEmitter{constructor(e){super(),V(this,"_ctx",void 0),this._ctx=e,this.ctx.caller.on("#lsp#request#callback",e=>{let t=null==e?void 0:e.requestId;t&&this.emit(X(t),null==e?void 0:e.payload)})}static createRequestTask(e,t,n){return new Z(e,t,n)}async _request(e){let t=this.ctx.baseInfo.id,{success:n,fail:r,final:i,...o}=e,a=this.ctx.Experiments.invokeExperMethod("request",t,o),s=K.createRequestTask(this.ctx.Request,a,e);return o.abortable?s:s.promise}get ctx(){return this._ctx}}let ee=Array.isArray,et="object"==typeof x&&x&&x.Object===Object&&x;var en="object"==typeof self&&self&&self.Object===Object&&self;let er=et||en||Function("return this")(),ei=er.Symbol;var eo=Object.prototype,ea=eo.hasOwnProperty,es=eo.toString,el=ei?ei.toStringTag:void 0;let eu=function(e){var t=ea.call(e,el),n=e[el];try{e[el]=void 0;var r=!0}catch(e){}var i=es.call(e);return r&&(t?e[el]=n:delete e[el]),i};var ec=Object.prototype.toString,ed=ei?ei.toStringTag:void 0;let ef=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ed&&ed in Object(e)?eu(e):ec.call(e)},eh=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},ep=function(e){if(!eh(e))return!1;var t=ef(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},em=er["__core-js_shared__"];var eg,ev=(eg=/[^.]+$/.exec(em&&em.keys&&em.keys.IE_PROTO||""))?"Symbol(src)_1."+eg:"",ey=Function.prototype.toString;let eb=function(e){if(null!=e){try{return ey.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var ew=/^\[object .+?Constructor\]$/,e_=Object.prototype,eC=Function.prototype.toString,ex=e_.hasOwnProperty,eS=RegExp("^"+eC.call(ex).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let ek=function(e,t){var n,r=null==e?void 0:e[t];return!(!eh(n=r)||ev&&ev in n)&&(ep(n)?eS:ew).test(eb(n))?r:void 0},eT=function(){try{var e=ek(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),eO=function(e,t,n){"__proto__"==t&&eT?eT(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},eM=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[++r];if(!1===t(i[s],s,i))break}return e},eE=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},eA=function(e){return null!=e&&"object"==typeof e},ej=function(e){return eA(e)&&"[object Arguments]"==ef(e)};var eD=Object.prototype,eN=eD.hasOwnProperty,eI=eD.propertyIsEnumerable;let eP=ej(function(){return arguments}())?ej:function(e){return eA(e)&&eN.call(e,"callee")&&!eI.call(e,"callee")};var eF=t&&!t.nodeType&&t,eL=eF&&e&&!e.nodeType&&e,e$=eL&&eL.exports===eF?er.Buffer:void 0;let eU=(e$?e$.isBuffer:void 0)||function(){return!1};var eR=/^(?:0|[1-9]\d*)$/;let ez=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&eR.test(e))&&e>-1&&e%1==0&&e<t},eH=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var eq={};eq["[object Float32Array]"]=eq["[object Float64Array]"]=eq["[object Int8Array]"]=eq["[object Int16Array]"]=eq["[object Int32Array]"]=eq["[object Uint8Array]"]=eq["[object Uint8ClampedArray]"]=eq["[object Uint16Array]"]=eq["[object Uint32Array]"]=!0,eq["[object Arguments]"]=eq["[object Array]"]=eq["[object ArrayBuffer]"]=eq["[object Boolean]"]=eq["[object DataView]"]=eq["[object Date]"]=eq["[object Error]"]=eq["[object Function]"]=eq["[object Map]"]=eq["[object Number]"]=eq["[object Object]"]=eq["[object RegExp]"]=eq["[object Set]"]=eq["[object String]"]=eq["[object WeakMap]"]=!1;var eW=t&&!t.nodeType&&t,eB=eW&&e&&!e.nodeType&&e,eY=eB&&eB.exports===eW&&et.process,eG=function(){try{return eB&&eB.require&&eB.require("util").types||eY&&eY.binding&&eY.binding("util")}catch(e){}}(),eJ=eG&&eG.isTypedArray;let eQ=eJ?function(e){return eJ(e)}:function(e){return eA(e)&&eH(e.length)&&!!eq[ef(e)]};var eV=Object.prototype.hasOwnProperty;let eX=function(e,t){var n=ee(e),r=!n&&eP(e),i=!n&&!r&&eU(e),o=!n&&!r&&!i&&eQ(e),a=n||r||i||o,s=a?eE(e.length,String):[],l=s.length;for(var u in e)!t&&!eV.call(e,u)||a&&("length"==u||i&&("offset"==u||"parent"==u)||o&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ez(u,l))||s.push(u);return s};var eZ=Object.prototype;let eK=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||eZ)},e0=(n=Object.keys,r=Object,function(e){return n(r(e))});var e1=Object.prototype.hasOwnProperty;let e3=function(e){if(!eK(e))return e0(e);var t=[];for(var n in Object(e))e1.call(e,n)&&"constructor"!=n&&t.push(n);return t},e2=function(e){return null!=e&&eH(e.length)&&!ep(e)?eX(e):e3(e)},e6=function(e,t){return e===t||e!=e&&t!=t},e9=function(e,t){for(var n=e.length;n--;)if(e6(e[n][0],t))return n;return -1};var e4=Array.prototype.splice;function e5(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}e5.prototype.clear=function(){this.__data__=[],this.size=0},e5.prototype.delete=function(e){var t=this.__data__,n=e9(t,e);return!(n<0)&&(n==t.length-1?t.pop():e4.call(t,n,1),--this.size,!0)},e5.prototype.get=function(e){var t=this.__data__,n=e9(t,e);return n<0?void 0:t[n][1]},e5.prototype.has=function(e){return e9(this.__data__,e)>-1},e5.prototype.set=function(e,t){var n=this.__data__,r=e9(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};let e7=ek(er,"Map"),e8=ek(Object,"create");var te=Object.prototype.hasOwnProperty,tt=Object.prototype.hasOwnProperty;function tn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}tn.prototype.clear=function(){this.__data__=e8?e8(null):{},this.size=0},tn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},tn.prototype.get=function(e){var t=this.__data__;if(e8){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return te.call(t,e)?t[e]:void 0},tn.prototype.has=function(e){var t=this.__data__;return e8?void 0!==t[e]:tt.call(t,e)},tn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=e8&&void 0===t?"__lodash_hash_undefined__":t,this};let tr=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},ti=function(e,t){var n=e.__data__;return tr(t)?n["string"==typeof t?"string":"hash"]:n.map};function to(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ta(e){var t=this.__data__=new e5(e);this.size=t.size}function ts(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new to;++t<n;)this.add(e[t])}to.prototype.clear=function(){this.size=0,this.__data__={hash:new tn,map:new(e7||e5),string:new tn}},to.prototype.delete=function(e){var t=ti(this,e).delete(e);return this.size-=t?1:0,t},to.prototype.get=function(e){return ti(this,e).get(e)},to.prototype.has=function(e){return ti(this,e).has(e)},to.prototype.set=function(e,t){var n=ti(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},ta.prototype.clear=function(){this.__data__=new e5,this.size=0},ta.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},ta.prototype.get=function(e){return this.__data__.get(e)},ta.prototype.has=function(e){return this.__data__.has(e)},ta.prototype.set=function(e,t){var n=this.__data__;if(n instanceof e5){var r=n.__data__;if(!e7||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new to(r)}return n.set(e,t),this.size=n.size,this},ts.prototype.add=ts.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ts.prototype.has=function(e){return this.__data__.has(e)};let tl=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},tu=function(e,t,n,r,i,o){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var u=o.get(e),c=o.get(t);if(u&&c)return u==t&&c==e;var d=-1,f=!0,h=2&n?new ts:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var p=e[d],m=t[d];if(r)var g=a?r(m,p,d,t,e,o):r(p,m,d,e,t,o);if(void 0!==g){if(g)continue;f=!1;break}if(h){if(!tl(t,function(e,t){if(!h.has(t)&&(p===e||i(p,e,n,r,o)))return h.push(t)})){f=!1;break}}else if(p!==m&&!i(p,m,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f},tc=er.Uint8Array,td=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n},tf=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n};var th=ei?ei.prototype:void 0,tp=th?th.valueOf:void 0;let tm=function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new tc(e),new tc(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return e6(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=td;case"[object Set]":var l=1&r;if(s||(s=tf),e.size!=t.size&&!l)break;var u=a.get(e);if(u)return u==t;r|=2,a.set(e,t);var c=tu(s(e),s(t),r,i,o,a);return a.delete(e),c;case"[object Symbol]":if(tp)return tp.call(e)==tp.call(t)}return!1},tg=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},tv=function(e,t,n){var r=t(e);return ee(e)?r:tg(r,n(e))},ty=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o};var tb=Object.prototype.propertyIsEnumerable,tw=Object.getOwnPropertySymbols;let t_=tw?function(e){return null==e?[]:ty(tw(e=Object(e)),function(t){return tb.call(e,t)})}:function(){return[]},tC=function(e){return tv(e,e2,t_)};var tx=Object.prototype.hasOwnProperty;let tS=function(e,t,n,r,i,o){var a=1&n,s=tC(e),l=s.length;if(l!=tC(t).length&&!a)return!1;for(var u=l;u--;){var c=s[u];if(!(a?c in t:tx.call(t,c)))return!1}var d=o.get(e),f=o.get(t);if(d&&f)return d==t&&f==e;var h=!0;o.set(e,t),o.set(t,e);for(var p=a;++u<l;){var m=e[c=s[u]],g=t[c];if(r)var v=a?r(g,m,c,t,e,o):r(m,g,c,e,t,o);if(!(void 0===v?m===g||i(m,g,n,r,o):v)){h=!1;break}p||(p="constructor"==c)}if(h&&!p){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(h=!1)}return o.delete(e),o.delete(t),h},tk=ek(er,"DataView"),tT=ek(er,"Promise"),tO=ek(er,"Set"),tM=ek(er,"WeakMap");var tE="[object Map]",tA="[object Promise]",tj="[object Set]",tD="[object WeakMap]",tN="[object DataView]",tI=eb(tk),tP=eb(e7),tF=eb(tT),tL=eb(tO),t$=eb(tM),tU=ef;(tk&&tU(new tk(new ArrayBuffer(1)))!=tN||e7&&tU(new e7)!=tE||tT&&tU(tT.resolve())!=tA||tO&&tU(new tO)!=tj||tM&&tU(new tM)!=tD)&&(tU=function(e){var t=ef(e),n="[object Object]"==t?e.constructor:void 0,r=n?eb(n):"";if(r)switch(r){case tI:return tN;case tP:return tE;case tF:return tA;case tL:return tj;case t$:return tD}return t});let tR=tU;var tz="[object Arguments]",tH="[object Array]",tq="[object Object]",tW=Object.prototype.hasOwnProperty;let tB=function(e,t,n,r,i,o){var a=ee(e),s=ee(t),l=a?tH:tR(e),u=s?tH:tR(t),c=(l=l==tz?tq:l)==tq,d=(u=u==tz?tq:u)==tq,f=l==u;if(f&&eU(e)){if(!eU(t))return!1;a=!0,c=!1}if(f&&!c)return o||(o=new ta),a||eQ(e)?tu(e,t,n,r,i,o):tm(e,t,l,n,r,i,o);if(!(1&n)){var h=c&&tW.call(e,"__wrapped__"),p=d&&tW.call(t,"__wrapped__");if(h||p){var m=h?e.value():e,g=p?t.value():t;return o||(o=new ta),i(m,g,n,r,o)}}return!!f&&(o||(o=new ta),tS(e,t,n,r,i,o))},tY=function e(t,n,r,i,o){return t===n||(null!=t&&null!=n&&(eA(t)||eA(n))?tB(t,n,r,i,e,o):t!=t&&n!=n)},tG=function(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var l=(s=n[i])[0],u=e[l],c=s[1];if(a&&s[2]){if(void 0===u&&!(l in e))return!1}else{var d=new ta;if(r)var f=r(u,c,l,e,t,d);if(!(void 0===f?tY(c,u,3,r,d):f))return!1}}return!0},tJ=function(e){return e==e&&!eh(e)},tQ=function(e){for(var t=e2(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,tJ(i)]}return t},tV=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},tX=function(e){var t=tQ(e);return 1==t.length&&t[0][2]?tV(t[0][0],t[0][1]):function(n){return n===e||tG(n,e,t)}},tZ=function(e){return"symbol"==typeof e||eA(e)&&"[object Symbol]"==ef(e)};var tK=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,t0=/^\w*$/;let t1=function(e,t){if(ee(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!tZ(e))||t0.test(e)||!tK.test(e)||null!=t&&e in Object(t)};function t3(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(t3.Cache||to),n}t3.Cache=to;var t2=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,t6=/\\(\\)?/g;let t9=(s=(a=t3(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(t2,function(e,n,r,i){t.push(r?i.replace(t6,"$1"):n||e)}),t},function(e){return 500===s.size&&s.clear(),e})).cache,a),t4=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};var t5=ei?ei.prototype:void 0,t7=t5?t5.toString:void 0;let t8=function e(t){if("string"==typeof t)return t;if(ee(t))return t4(t,e)+"";if(tZ(t))return t7?t7.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},ne=function(e,t){return ee(e)?e:t1(e,t)?[e]:t9(null==e?"":t8(e))},nt=function(e){if("string"==typeof e||tZ(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},nn=function(e,t){for(var n=0,r=(t=ne(t,e)).length;null!=e&&n<r;)e=e[nt(t[n++])];return n&&n==r?e:void 0},nr=function(e,t,n){var r=null==e?void 0:nn(e,t);return void 0===r?n:r},ni=function(e,t){return null!=e&&t in Object(e)},no=function(e,t,n){for(var r=-1,i=(t=ne(t,e)).length,o=!1;++r<i;){var a=nt(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&eH(i)&&ez(a,i)&&(ee(e)||eP(e))},na=function(e){return e},ns=function(e){var t;return t1(e)?(t=nt(e),function(e){return null==e?void 0:e[t]}):function(t){return nn(t,e)}},nl=function(e){var t,n;return"function"==typeof e?e:null==e?na:"object"==typeof e?ee(e)?(t=e[0],n=e[1],t1(t)&&tJ(n)?tV(nt(t),n):function(e){var r=nr(e,t);return void 0===r&&r===n?null!=e&&no(e,t,ni):tY(n,r,3)}):tX(e):ns(e)},nu=function(e,t){var n,r={};return t=nl(t,3),n=function(e,n,i){eO(r,t(e,n,i),e)},e&&eM(e,n,e2),r};function nc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nd{constructor(e,t){nc(this,"ctx",void 0),nc(this,"serviceHooks",void 0),this.ctx=e,this.serviceHooks=t,e._execCallableAPI("register-search-service",e.baseInfo.id,t.name,t.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:e=>(ee(null==e?void 0:e.blocks)&&(e.blocks=e.blocks.map(e=>e&&nu(e,(e,t)=>`block/${t}`))),e)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([n,r])=>{let i=`service:search:${n}:${t.name}`;e.caller.on(i,async n=>{if(ep(null==t?void 0:t[r.f])){let o=null;try{o=await t[r.f].apply(t,(r.args||[]).map(e=>{if(n){if(!0===e)return n;if(n.hasOwnProperty(e)){let t=n[e];return delete n[e],t}}})),r.transformOutput&&(o=r.transformOutput(o))}catch(e){console.error("[SearchService] ",e),o=e}finally{r.reply&&e.caller.call(`${i}:reply`,o)}}})})}}function nf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let nh=Symbol.for("proxy-continue"),np=T()("LSPlugin:user"),nm=new _("",{console:!0});function ng(e,t,n){var r;let{key:i,label:o,desc:a,palette:s,keybinding:l,extras:u}=t;if("function"!=typeof n)return this.logger.error(`${i||o}: command action should be function.`),!1;let c=function(e){if("string"==typeof e)return e.trim().replace(/\s/g,"_").toLowerCase()}(i);if(!c)return this.logger.error(`${o}: command key is required.`),!1;let d=`SimpleCommandHook${c}${++n_}`;this.Editor["on"+d](n),null===(r=this.caller)||void 0===r||r.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:c,label:o,type:e,desc:a,keybinding:l,extras:u},["editor/hook",d]],s]})}function nv(e){return!("string"!=typeof e||36!==e.length||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(e))||(nm.error(`#${e} is not a valid UUID string.`),!1)}let ny=null,nb=new Map,nw={async getInfo(e){return ny||(ny=await this._execCallableAPIAsync("get-app-info")),"string"==typeof e?ny[e]:ny},registerCommand:ng,registerSearchService(e){if(nb.has(e.name))throw Error(`SearchService: #${e.name} has registered!`);nb.set(e.name,new nd(this,e))},registerCommandPalette(e,t){let{key:n,label:r,keybinding:i}=e;return ng.call(this,"$palette$",{key:n,label:r,palette:!0,keybinding:i},t)},registerCommandShortcut(e,t,n={}){"string"==typeof e&&(e={mode:"global",binding:e});let{binding:r}=e,i="$shortcut$",o=n.key||i+w(null==r?void 0:r.toString());return ng.call(this,i,{...n,key:o,palette:!1,keybinding:e},t)},registerUIItem(e,t){var n;let r=this.baseInfo.id;null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-ui-item",args:[r,e,t]})},registerPageMenuItem(e,t){if("function"!=typeof t)return!1;let n=e+"_"+this.baseInfo.id;ng.call(this,"page-menu-item",{key:n,label:e},t)},onBlockRendererSlotted(e,t){if(!nv(e))return;let n=this.baseInfo.id,r=`hook:editor:${w(`slot:${e}`)}`;return this.caller.on(r,t),this.App._installPluginHook(n,r),()=>{this.caller.off(r,t),this.App._uninstallPluginHook(n,r)}},invokeExternalPlugin(e,...t){var n;if(!(e=null===(n=e)||void 0===n?void 0:n.trim()))return;let[r,i]=e.split(".");if(!["models","commands"].includes(null==i?void 0:i.toLowerCase()))throw Error("Type only support '.models' or '.commands' currently.");let o=e.replace(`${r}.${i}.`,"");if(!r||!i||!o)throw Error(`Illegal type of #${e} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",r,i.toLowerCase(),o,t)},setFullScreen(e){let t=(...e)=>this._callWin("setFullScreen",...e);"toggle"===e?this._callWin("isFullScreen").then(e=>{e?t():t(!0)}):e?t(!0):t()}},n_=0,nC={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(e,t){var n;np("Register slash command #",this.baseInfo.id,e,t),"function"==typeof t&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map(e=>{let[t,...n]=e;if("editor/hook"===t){let r=n[0],i=()=>{var e;null===(e=this.caller)||void 0===e||e.callUserModel(r)};"function"==typeof r&&(i=r);let o=`SlashCommandHook${t}${++n_}`;e[1]=o,this.Editor["on"+o](i)}return e}),null===(n=this.caller)||void 0===n||n.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if("function"!=typeof t)return!1;let n=e+"_"+this.baseInfo.id;ng.call(this,"block-context-menu-item",{key:n,label:e},t)},registerHighlightContextMenuItem(e,t,n){if("function"!=typeof t)return!1;let r=e+"_"+this.baseInfo.id;ng.call(this,"highlight-context-menu-item",{key:r,label:e,extras:n},t)},scrollToBlockInPage(e,t,n){let r="block-content-"+t;null!=n&&n.replaceState?this.App.replaceState("page",{name:e},{anchor:r}):this.App.pushState("page",{name:e},{anchor:r})}},nx={onBlockChanged(e,t){if(!nv(e))return;let n=this.baseInfo.id,r=`hook:db:${w(`block:${e}`)}`,i=({block:n,txData:r,txMeta:i})=>{n.uuid===e&&t(n,r,i)};return this.caller.on(r,i),this.App._installPluginHook(n,r),()=>{this.caller.off(r,i),this.App._uninstallPluginHook(n,r)}},datascriptQuery(e,...t){return(t.pop(),null!=t&&t.some(e=>"function"==typeof e))?this.Experiments.ensureHostScope().logseq.api.datascript_query(e,...t):this._execCallableAPIAsync("datascript_query",e,...t)}},nS={},nk={},nT={makeSandboxStorage(){return new J(this,{assets:!0})}};class nO extends v(){constructor(e,t){super(),nf(this,"_baseInfo",void 0),nf(this,"_caller",void 0),nf(this,"_version","0.0.17"),nf(this,"_debugTag",""),nf(this,"_settingsSchema",void 0),nf(this,"_connected",!1),nf(this,"_ui",new Map),nf(this,"_mFileStorage",void 0),nf(this,"_mRequest",void 0),nf(this,"_mExperiments",void 0),nf(this,"_beforeunloadCallback",void 0),this._baseInfo=e,this._caller=t,t.on("sys:ui:visible",e=>{null!=e&&e.toggle&&this.toggleMainUI()}),t.on("settings:changed",e=>{let t=Object.assign({},this.settings),n=Object.assign(this._baseInfo.settings,e);this.emit("settings:changed",{...n},t)}),t.on("beforeunload",async e=>{let{actor:t,...n}=e,r=this._beforeunloadCallback;try{r&&await r(n),null==t||t.resolve(null)}catch(e){this.logger.error("[beforeunload] ",e),null==t||t.reject(e)}})}async ready(e,t){var n,r,i;if(!this._connected)try{"function"==typeof e&&(t=e,e={});let o=await this._caller.connectToParent(e);this._connected=!0,n=this._baseInfo,r=o,o=c()(n,r,{arrayMerge:(e,t)=>t}),this._baseInfo=o,null!==(i=o)&&void 0!==i&&i.id&&(this._debugTag=this._caller.debugTag=`#${o.id} [${o.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(o.settings=function(e,t){let n=(t||[]).reduce((e,t)=>("default"in t&&(e[t.key]=t.default),e),{});return Object.assign(n,e)}(o.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(e){console.warn(e)}t&&t.call(this,o)}catch(e){console.error(`${this._debugTag} [Ready Error]`,e)}}ensureConnected(){if(!this._connected)throw Error("not connected")}beforeunload(e){"function"==typeof e&&(this._beforeunloadCallback=e)}provideModel(e){return this.caller._extendUserModel(e),this}provideTheme(e){return this.caller.call("provider:theme",e),this}provideStyle(e){return this.caller.call("provider:style",e),this}provideUI(e){return this.caller.call("provider:ui",e),this}useSettingsSchema(e){return this.connected&&this.caller.call("settings:schema",{schema:e,isSync:!0}),this._settingsSchema=e,this}updateSettings(e){this.caller.call("settings:update",e)}onSettingsChanged(e){let t="settings:changed";return this.on(t,e),()=>this.off(t,e)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(e){this.caller.call("main-ui:attrs",e)}setMainUIInlineStyle(e){this.caller.call("main-ui:style",e)}hideMainUI(e){let t={key:0,visible:!1,cursor:null==e?void 0:e.restoreEditingCursor};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}showMainUI(e){let t={key:0,visible:!0,autoFocus:null==e?void 0:e.autoFocus};this.caller.call("main-ui:visible",t),this.emit("ui:visible:changed",t),this._ui.set(t.key,t)}toggleMainUI(){let e=this._ui.get(0);e&&e.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){let e=this._ui.get(0);return!!(e&&e.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){var e,t;return this&&((null===(e=this.baseInfo)||void 0===e?void 0:e.effect)||!(null!==(t=this.baseInfo)&&void 0!==t&&t.iir))}get logger(){return nm}get settings(){var e;return null===(e=this.baseInfo)||void 0===e?void 0:e.settings}get caller(){return this._caller}resolveResourceFullUrl(e){if(this.ensureConnected(),e)return e=e.replace(/^[.\\/]+/,""),function(e,...t){try{let n=new URL(e);if(!n.origin)throw Error(null);let r=b.join(e.substr(n.origin.length),...t);return n.origin+r}catch(n){return b.join(e,...t)}}(this._baseInfo.lsr,e)}_makeUserProxy(e,t){let n=this,r=this.caller;return new Proxy(e,{get(e,i,o){let a=e[i];return function(...e){if(a){let r=a.apply(n,e.concat(t));if(r!==nh)return r}if(t){let o=i.toString().match(/^(once|off|on)/i);if(null!=o){let i=o[0].toLowerCase(),a=o.input,s="off"===i,l=n.baseInfo.id,u=a.slice(i.length),c=e[0],d=e[1];"string"==typeof c&&"function"==typeof d&&(c=c.replace(/^logseq./,":"),u=`${u}${c}`,c=d,d=e[2]),u=`hook:${t}:${w(u)}`,r[i](u,c);let f=()=>{r.off(u,c),r.listenerCount(u)||n.App._uninstallPluginHook(l,u)};return s?void f():(n.App._installPluginHook(l,u,d),f)}}let o=i;return["git","ui","assets"].includes(t)&&(o=t+"_"+o),r.callAsync("api:call",{tag:t,method:o,args:e})}}})}_execCallableAPIAsync(e,...t){return this._caller.callAsync("api:call",{method:e,args:t})}_execCallableAPI(e,...t){this._caller.call("api:call",{method:e,args:t})}_callWin(...e){return this._execCallableAPIAsync("_callMainWin",...e)}get App(){return this._makeUserProxy(nw,"app")}get Editor(){return this._makeUserProxy(nC,"editor")}get DB(){return this._makeUserProxy(nx,"db")}get Git(){return this._makeUserProxy(nS,"git")}get UI(){return this._makeUserProxy(nk,"ui")}get Assets(){return this._makeUserProxy(nT,"assets")}get FileStorage(){let e=this._mFileStorage;return e||(e=this._mFileStorage=new J(this)),e}get Request(){let e=this._mRequest;return e||(e=this._mRequest=new K(this)),e}get Experiments(){let e=this._mExperiments;return e||(e=this._mExperiments=new Q(this)),e}}function nM(e,t){return new nO(e,t)}if(null==window.__LSP__HOST__){let e=new Y(null);window.logseq=nM({},e)}})(),o})(),e.exports=n()}),O("cVm5l");var M={};function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(t.length<e)throw TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function j(e){A(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===E(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):(("string"==typeof e||"[object String]"===t)&&"undefined"!=typeof console&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(Error().stack)),new Date(NaN))}function D(e){if(null===e||!0===e||!1===e)return NaN;var t=Number(e);return isNaN(t)?t:t<0?Math.ceil(t):Math.floor(t)}function N(e){A(1,arguments);var t=j(e),n=t.getUTCDay();return t.setUTCDate(t.getUTCDate()-((n<1?7:0)+n-1)),t.setUTCHours(0,0,0,0),t}function I(e){A(1,arguments);var t=j(e),n=t.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(n+1,0,4),r.setUTCHours(0,0,0,0);var i=N(r),o=new Date(0);o.setUTCFullYear(n,0,4),o.setUTCHours(0,0,0,0);var a=N(o);return t.getTime()>=i.getTime()?n+1:t.getTime()>=a.getTime()?n:n-1}e="millisecond",t="second",n="minute",r="hour",i="week",o="month",a="quarter",s="year",l="date",u="Invalid Date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,d=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},(p={})[h="en"]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||"th")+"]"}},m="$isDayjsObject",g=function(e){return e instanceof w||!(!e||!e[m])},v=function e(t,n,r){var i;if(!t)return h;if("string"==typeof t){var o=t.toLowerCase();p[o]&&(i=o),n&&(p[o]=n,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;p[s]=t,i=s}return!r&&i&&(h=i),i||!r&&h},y=function(e,t){if(g(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new w(n)},(b={s:f,z:function(e){var t=-e.utcOffset(),n=Math.abs(t);return(t<=0?"+":"-")+f(Math.floor(n/60),2,"0")+":"+f(n%60,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,o),a=n-i<0,s=t.clone().add(r+(a?-1:1),o);return+(-(r+(n-i)/(a?i-s:s-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(u){return({M:o,y:s,w:i,d:"day",D:l,h:r,m:n,s:t,ms:e,Q:a})[u]||String(u||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}}).l=v,b.i=g,b.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})},_=(w=function(){function f(e){this.$L=v(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[m]=!0}var h=f.prototype;return h.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(b.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(c);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.init()},h.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},h.$utils=function(){return b},h.isValid=function(){return this.$d.toString()!==u},h.isSame=function(e,t){var n=y(e);return this.startOf(t)<=n&&n<=this.endOf(t)},h.isAfter=function(e,t){return y(e)<this.startOf(t)},h.isBefore=function(e,t){return this.endOf(t)<y(e)},h.$g=function(e,t,n){return b.u(e)?this[t]:this.set(n,e)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(e,a){var u=this,c=!!b.u(a)||a,d=b.p(e),f=function(e,t){var n=b.w(u.$u?Date.UTC(u.$y,t,e):new Date(u.$y,t,e),u);return c?n:n.endOf("day")},h=function(e,t){return b.w(u.toDate()[e].apply(u.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),u)},p=this.$W,m=this.$M,g=this.$D,v="set"+(this.$u?"UTC":"");switch(d){case s:return c?f(1,0):f(31,11);case o:return c?f(1,m):f(0,m+1);case i:var y=this.$locale().weekStart||0,w=(p<y?p+7:p)-y;return f(c?g-w:g+(6-w),m);case"day":case l:return h(v+"Hours",0);case r:return h(v+"Minutes",1);case n:return h(v+"Seconds",2);case t:return h(v+"Milliseconds",3);default:return this.clone()}},h.endOf=function(e){return this.startOf(e,!1)},h.$set=function(i,a){var u,c=b.p(i),d="set"+(this.$u?"UTC":""),f=((u={}).day=d+"Date",u[l]=d+"Date",u[o]=d+"Month",u[s]=d+"FullYear",u[r]=d+"Hours",u[n]=d+"Minutes",u[t]=d+"Seconds",u[e]=d+"Milliseconds",u)[c],h="day"===c?this.$D+(a-this.$W):a;if(c===o||c===s){var p=this.clone().set(l,1);p.$d[f](h),p.init(),this.$d=p.set(l,Math.min(this.$D,p.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},h.set=function(e,t){return this.clone().$set(e,t)},h.get=function(e){return this[b.p(e)]()},h.add=function(e,a){var l,u=this;e=Number(e);var c=b.p(a),d=function(t){var n=y(u);return b.w(n.date(n.date()+Math.round(t*e)),u)};if(c===o)return this.set(o,this.$M+e);if(c===s)return this.set(s,this.$y+e);if("day"===c)return d(1);if(c===i)return d(7);var f=((l={})[n]=6e4,l[r]=36e5,l[t]=1e3,l)[c]||1,h=this.$d.getTime()+e*f;return b.w(h,this)},h.subtract=function(e,t){return this.add(-1*e,t)},h.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||u;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=b.z(this),o=this.$H,a=this.$m,s=this.$M,l=n.weekdays,c=n.months,f=n.meridiem,h=function(e,n,i,o){return e&&(e[n]||e(t,r))||i[n].slice(0,o)},p=function(e){return b.s(o%12||12,e,"0")},m=f||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(d,function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return b.s(t.$y,4,"0");case"M":return s+1;case"MM":return b.s(s+1,2,"0");case"MMM":return h(n.monthsShort,s,c,3);case"MMMM":return h(c,s);case"D":return t.$D;case"DD":return b.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(n.weekdaysMin,t.$W,l,2);case"ddd":return h(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(o);case"HH":return b.s(o,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return m(o,a,!0);case"A":return m(o,a,!1);case"m":return String(a);case"mm":return b.s(a,2,"0");case"s":return String(t.$s);case"ss":return b.s(t.$s,2,"0");case"SSS":return b.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")})},h.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},h.diff=function(e,l,u){var c,d=this,f=b.p(l),h=y(e),p=(h.utcOffset()-this.utcOffset())*6e4,m=this-h,g=function(){return b.m(d,h)};switch(f){case s:c=g()/12;break;case o:c=g();break;case a:c=g()/3;break;case i:c=(m-p)/6048e5;break;case"day":c=(m-p)/864e5;break;case r:c=m/36e5;break;case n:c=m/6e4;break;case t:c=m/1e3;break;default:c=m}return u?c:b.a(c)},h.daysInMonth=function(){return this.endOf(o).$D},h.$locale=function(){return p[this.$L]},h.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=v(e,t,!0);return r&&(n.$L=r),n},h.clone=function(){return b.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},f}()).prototype,y.prototype=_,[["$ms",e],["$s",t],["$m",n],["$H",r],["$W","day"],["$M",o],["$y",s],["$D",l]].forEach(function(e){_[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),y.extend=function(e,t){return e.$i||(e(t,w,y),e.$i=!0),y},y.locale=v,y.isDayjs=g,y.unix=function(e){return y(1e3*e)},y.en=p[h],y.Ls=p,y.p={},M=y;var P={};function F(e,t){A(1,arguments);var n,r,i,o,a,s,l,u,c=D(null!==(n=null!==(r=null!==(i=null!==(o=null==t?void 0:t.weekStartsOn)&&void 0!==o?o:null==t?void 0:null===(a=t.locale)||void 0===a?void 0:null===(s=a.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==i?i:P.weekStartsOn)&&void 0!==r?r:null===(l=P.locale)||void 0===l?void 0:null===(u=l.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==n?n:0);if(!(c>=0&&c<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");var d=j(e),f=d.getUTCDay();return d.setUTCDate(d.getUTCDate()-((f<c?7:0)+f-c)),d.setUTCHours(0,0,0,0),d}function L(e,t){A(1,arguments);var n,r,i,o,a,s,l,u,c=j(e),d=c.getUTCFullYear(),f=D(null!==(n=null!==(r=null!==(i=null!==(o=null==t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null==t?void 0:null===(a=t.locale)||void 0===a?void 0:null===(s=a.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==i?i:P.firstWeekContainsDate)&&void 0!==r?r:null===(l=P.locale)||void 0===l?void 0:null===(u=l.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==n?n:1);if(!(f>=1&&f<=7))throw RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var h=new Date(0);h.setUTCFullYear(d+1,0,f),h.setUTCHours(0,0,0,0);var p=F(h,t),m=new Date(0);m.setUTCFullYear(d,0,f),m.setUTCHours(0,0,0,0);var g=F(m,t);return c.getTime()>=p.getTime()?d+1:c.getTime()>=g.getTime()?d:d-1}function $(e,t){for(var n=Math.abs(e).toString();n.length<t;)n="0"+n;return(e<0?"-":"")+n}var U={y:function(e,t){var n=e.getUTCFullYear(),r=n>0?n:1-n;return $("yy"===t?r%100:r,t.length)},M:function(e,t){var n=e.getUTCMonth();return"M"===t?String(n+1):$(n+1,2)},d:function(e,t){return $(e.getUTCDate(),t.length)},h:function(e,t){return $(e.getUTCHours()%12||12,t.length)},H:function(e,t){return $(e.getUTCHours(),t.length)},m:function(e,t){return $(e.getUTCMinutes(),t.length)},s:function(e,t){return $(e.getUTCSeconds(),t.length)},S:function(e,t){var n=t.length;return $(Math.floor(e.getUTCMilliseconds()*Math.pow(10,n-3)),t.length)}},R={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};function z(e,t){var n=e>0?"-":"+",r=Math.abs(e),i=Math.floor(r/60),o=r%60;return 0===o?n+String(i):n+String(i)+(t||"")+$(o,2)}function H(e,t){return e%60==0?(e>0?"-":"+")+$(Math.abs(e)/60,2):q(e,t)}function q(e,t){var n=Math.abs(e);return(e>0?"-":"+")+$(Math.floor(n/60),2)+(t||"")+$(n%60,2)}var W={G:function(e,t,n){var r=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if("yo"===t){var r=e.getUTCFullYear();return n.ordinalNumber(r>0?r:1-r,{unit:"year"})}return U.y(e,t)},Y:function(e,t,n,r){var i=L(e,r),o=i>0?i:1-i;return"YY"===t?$(o%100,2):"Yo"===t?n.ordinalNumber(o,{unit:"year"}):$(o,t.length)},R:function(e,t){return $(I(e),t.length)},u:function(e,t){return $(e.getUTCFullYear(),t.length)},Q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return $(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){var r=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return $(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){var r=e.getUTCMonth();switch(t){case"M":case"MM":return U.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){var r=e.getUTCMonth();switch(t){case"L":return String(r+1);case"LL":return $(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){var i=function(e,t){A(1,arguments);var n=j(e);return Math.round((F(n,t).getTime()-(function(e,t){A(1,arguments);var n,r,i,o,a,s,l,u,c=D(null!==(n=null!==(r=null!==(i=null!==(o=null==t?void 0:t.firstWeekContainsDate)&&void 0!==o?o:null==t?void 0:null===(a=t.locale)||void 0===a?void 0:null===(s=a.options)||void 0===s?void 0:s.firstWeekContainsDate)&&void 0!==i?i:P.firstWeekContainsDate)&&void 0!==r?r:null===(l=P.locale)||void 0===l?void 0:null===(u=l.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==n?n:1),d=L(e,t),f=new Date(0);return f.setUTCFullYear(d,0,c),f.setUTCHours(0,0,0,0),F(f,t)})(n,t).getTime())/6048e5)+1}(e,r);return"wo"===t?n.ordinalNumber(i,{unit:"week"}):$(i,t.length)},I:function(e,t,n){var r=function(e){A(1,arguments);var t=j(e);return Math.round((N(t).getTime()-(function(e){A(1,arguments);var t=I(e),n=new Date(0);return n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0),N(n)})(t).getTime())/6048e5)+1}(e);return"Io"===t?n.ordinalNumber(r,{unit:"week"}):$(r,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getUTCDate(),{unit:"date"}):U.d(e,t)},D:function(e,t,n){var r=function(e){A(1,arguments);var t=j(e),n=t.getTime();return t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0),Math.floor((n-t.getTime())/864e5)+1}(e);return"Do"===t?n.ordinalNumber(r,{unit:"dayOfYear"}):$(r,t.length)},E:function(e,t,n){var r=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){var i=e.getUTCDay(),o=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return $(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){var i=e.getUTCDay(),o=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return $(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){var r=e.getUTCDay(),i=0===r?7:r;switch(t){case"i":return String(i);case"ii":return $(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(e,t,n){var r,i=e.getUTCHours();switch(r=12===i?R.noon:0===i?R.midnight:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){var r,i=e.getUTCHours();switch(r=i>=17?R.evening:i>=12?R.afternoon:i>=4?R.morning:R.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){var r=e.getUTCHours()%12;return 0===r&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return U.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getUTCHours(),{unit:"hour"}):U.H(e,t)},K:function(e,t,n){var r=e.getUTCHours()%12;return"Ko"===t?n.ordinalNumber(r,{unit:"hour"}):$(r,t.length)},k:function(e,t,n){var r=e.getUTCHours();return(0===r&&(r=24),"ko"===t)?n.ordinalNumber(r,{unit:"hour"}):$(r,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):U.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):U.s(e,t)},S:function(e,t){return U.S(e,t)},X:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return H(i);case"XXXX":case"XX":return q(i);default:return q(i,":")}},x:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"x":return H(i);case"xxxx":case"xx":return q(i);default:return q(i,":")}},O:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+z(i,":");default:return"GMT"+q(i,":")}},z:function(e,t,n,r){var i=(r._originalDate||e).getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+z(i,":");default:return"GMT"+q(i,":")}},t:function(e,t,n,r){return $(Math.floor((r._originalDate||e).getTime()/1e3),t.length)},T:function(e,t,n,r){return $((r._originalDate||e).getTime(),t.length)}},B=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Y=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},G={p:Y,P:function(e,t){var n,r=e.match(/(P+)(p+)?/)||[],i=r[1],o=r[2];if(!o)return B(e,t);switch(i){case"P":n=t.dateTime({width:"short"});break;case"PP":n=t.dateTime({width:"medium"});break;case"PPP":n=t.dateTime({width:"long"});break;default:n=t.dateTime({width:"full"})}return n.replace("{{date}}",B(i,t)).replace("{{time}}",Y(o,t))}},J=["D","DD"],Q=["YY","YYYY"];function V(e,t,n){if("YYYY"===e)throw RangeError("Use `yyyy` instead of `YYYY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("YY"===e)throw RangeError("Use `yy` instead of `YY` (in `".concat(t,"`) for formatting years to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("D"===e)throw RangeError("Use `d` instead of `D` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if("DD"===e)throw RangeError("Use `dd` instead of `DD` (in `".concat(t,"`) for formatting days of the month to the input `").concat(n,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var X={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Z(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}var K={date:Z({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Z({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Z({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ee={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function et(e){return function(t,n){var r;if("formatting"===(null!=n&&n.context?String(n.context):"standalone")&&e.formattingValues){var i=e.defaultFormattingWidth||e.defaultWidth,o=null!=n&&n.width?String(n.width):i;r=e.formattingValues[o]||e.formattingValues[i]}else{var a=e.defaultWidth,s=null!=n&&n.width?String(n.width):e.defaultWidth;r=e.values[s]||e.values[a]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function en(e){return function(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],a=t.match(o);if(!a)return null;var s=a[0],l=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(l)?function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return n}(l,function(e){return e.test(s)}):function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n]))return n}(l,function(e){return e.test(s)});return n=e.valueCallback?e.valueCallback(u):u,{value:n=r.valueCallback?r.valueCallback(n):n,rest:t.slice(s.length)}}}var er={code:"en-US",formatDistance:function(e,t,n){var r,i=X[e];return(r="string"==typeof i?i:1===t?i.one:i.other.replace("{{count}}",t.toString()),null!=n&&n.addSuffix)?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:K,formatRelative:function(e,t,n,r){return ee[e]},localize:{ordinalNumber:function(e,t){var n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:et({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:et({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:et({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:et({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:et({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(C={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:function(e){return parseInt(e,10)}},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.match(C.matchPattern);if(!n)return null;var r=n[0],i=e.match(C.parsePattern);if(!i)return null;var o=C.valueCallback?C.valueCallback(i[0]):i[0];return{value:o=t.valueCallback?t.valueCallback(o):o,rest:e.slice(r.length)}}),era:en({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:en({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:en({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:en({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:en({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},ei=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eo=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ea=/^'([^]*?)'?$/,es=/''/g,el=/[a-zA-Z]/,eu=function(e,t){return"[["+function(e,t,n){A(2,arguments);var r,i,o,a,s,l,u,c,d,f,h,p,m,g,v,y,b,w,_,C=String(t),x=null!==(i=null!==(o=null==n?void 0:n.locale)&&void 0!==o?o:P.locale)&&void 0!==i?i:er,S=D(null!==(a=null!==(s=null!==(l=null!==(u=null==n?void 0:n.firstWeekContainsDate)&&void 0!==u?u:null==n?void 0:null===(c=n.locale)||void 0===c?void 0:null===(d=c.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==l?l:P.firstWeekContainsDate)&&void 0!==s?s:null===(f=P.locale)||void 0===f?void 0:null===(h=f.options)||void 0===h?void 0:h.firstWeekContainsDate)&&void 0!==a?a:1);if(!(S>=1&&S<=7))throw RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var k=D(null!==(p=null!==(m=null!==(g=null!==(v=null==n?void 0:n.weekStartsOn)&&void 0!==v?v:null==n?void 0:null===(y=n.locale)||void 0===y?void 0:null===(b=y.options)||void 0===b?void 0:b.weekStartsOn)&&void 0!==g?g:P.weekStartsOn)&&void 0!==m?m:null===(w=P.locale)||void 0===w?void 0:null===(_=w.options)||void 0===_?void 0:_.weekStartsOn)&&void 0!==p?p:0);if(!(k>=0&&k<=6))throw RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!x.localize)throw RangeError("locale must contain localize property");if(!x.formatLong)throw RangeError("locale must contain formatLong property");var T=j(e);if(!function(e){return A(1,arguments),(!!function(e){return A(1,arguments),e instanceof Date||"object"===E(e)&&"[object Date]"===Object.prototype.toString.call(e)}(e)||"number"==typeof e)&&!isNaN(Number(j(e)))}(T))throw RangeError("Invalid time value");var O=((r=new Date(Date.UTC(T.getFullYear(),T.getMonth(),T.getDate(),T.getHours(),T.getMinutes(),T.getSeconds(),T.getMilliseconds()))).setUTCFullYear(T.getFullYear()),T.getTime()-r.getTime()),M=function(e,t){return A(2,arguments),function(e,t){return A(2,arguments),new Date(j(e).getTime()+D(t))}(e,-D(t))}(T,O),N={firstWeekContainsDate:S,weekStartsOn:k,locale:x,_originalDate:T};return C.match(eo).map(function(e){var t=e[0];return"p"===t||"P"===t?(0,G[t])(e,x.formatLong):e}).join("").match(ei).map(function(r){if("''"===r)return"'";var i,o=r[0];if("'"===o)return(i=r.match(ea))?i[1].replace(es,"'"):r;var a=W[o];if(a)return null!=n&&n.useAdditionalWeekYearTokens||-1===Q.indexOf(r)||V(r,t,String(e)),null!=n&&n.useAdditionalDayOfYearTokens||-1===J.indexOf(r)||V(r,t,String(e)),a(M,r,x.localize,N);if(o.match(el))throw RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");return r}).join("")}(e,t)+"]]"};const ec=e=>e?String(e).split(",").map(e=>e.trim()):[];logseq.useSettingsSchema([{default:"DONE, NOW, LATER, DOING, TODO, WAITING",description:"Task markers to track when changing the status of tasks.",title:"Task markers",key:"taskMarkers",type:"string"},{default:!0,description:"Include date when completing tasks.",title:"Include date?",key:"includeDate",type:"boolean"},{default:"completed",description:"Property to use for date when marking tasks as completed.",title:"Completed date property",key:"completedDateProperty",type:"string"},{default:!1,description:"Include time when completing tasks.",title:"Include time?",key:"includeTime",type:"boolean"},{default:"time",description:"Property to use for time when marking tasks as completed.",title:"Completed time property",key:"completedTimeProperty",type:"string"},{default:"HH:mm",description:"Time format to use when including time. See: https://day.js.org/docs/en/parse/string-format",title:"Time format",key:"timeFormat",type:"string"}]),logseq.ready(function(){let e=logseq.settings,t=new Set(ec(e?.taskMarkers));logseq.onSettingsChanged((n,r)=>{e=r,t=new Set(ec(e?.taskMarkers))}),logseq.DB.onChanged(async n=>{let r=n.blocks.find(e=>!!e.marker&&t.has(e.marker));if(!r)return;let i=r.properties?.completed,o=r.properties?.time;if("DONE"===r.marker){if(!i&&e?.includeDate){let t=(await logseq.App.getUserConfigs()).preferredDateFormat;t=t.replace(/E{1,3}/,"EEE");let n=eu(new Date,t);logseq.Editor.upsertBlockProperty(r.uuid,e?.completedDateProperty,n)}if(!o&&e?.includeTime){let t=S(M)().format(e?.timeFormat);logseq.Editor.upsertBlockProperty(r.uuid,e?.completedTimeProperty,t)}}else i&&logseq.Editor.removeBlockProperty(r.uuid,e?.completedDateProperty),o&&logseq.Editor.removeBlockProperty(r.uuid,e?.completedTimeProperty)}),logseq.Editor.registerSlashCommand("Completed tasks for the past week",async()=>{let e=await logseq.Editor.getCurrentBlock();if(!e)return;let t=(await logseq.App.getUserConfigs()).preferredDateFormat;t=t.replace(/E{1,3}/,"EEE");let n=S(M)(new Date),r="{{query (or ",i=[];for(let e=0;e<7;e++)i.push(`(property completed ${eu(n.subtract(e+1,"day").toDate(),t)})`);r+=i.join(" ")+") }}";let o=await logseq.Editor.insertBlock(e.uuid,"### Tasks completed last week",{before:!0});o&&(await logseq.Editor.insertBlock(o.uuid,r),await logseq.Editor.insertBlock(o.uuid,"---",{sibling:!0}))})}).catch(console.error);